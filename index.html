<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Guido Rugo&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Just a silly personal blog where I try to share some life experiences">
<meta property="og:type" content="website">
<meta property="og:title" content="Guido Rugo&#39;s Blog">
<meta property="og:url" content="https://blog.grugo.me/index.html">
<meta property="og:site_name" content="Guido Rugo&#39;s Blog">
<meta property="og:description" content="Just a silly personal blog where I try to share some life experiences">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Guido Rugo">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Guido Rugo&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Guido Rugo&#39;s Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://blog.grugo.me"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-How-to-install-and-set-up-hexo-nginx-let-s-encrypt" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/01/How-to-install-and-set-up-hexo-nginx-let-s-encrypt/" class="article-date">
  <time datetime="2020-05-01T11:07:24.000Z" itemprop="datePublished">2020-05-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/01/How-to-install-and-set-up-hexo-nginx-let-s-encrypt/">How to install and set up hexo + nginx + let&#39;s encrypt</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Most people can get by with using <a href="https://wordpress.org/" target="_blank" rel="noopener">Wordpress</a> or <a href="https://www.wix.com/" target="_blank" rel="noopener">Wiz</a>, wich does most of the blog-building work easy and user-friendly. However, Wordpress has grown past being just a blogging platform and as such it’s not as lightweight as it used to be, and you will have to navigating through thousands of templates and plugins, rather than build a simple static website to house posts and thoughts. Don’t get me wrong, WP is still a great tool, making easy to start a blog in a few minutes.</p>
<h2 id="What’s-Hexo"><a href="#What’s-Hexo" class="headerlink" title="What’s Hexo?"></a>What’s Hexo?</h2><p>A fast, simple and powerful blog framework for generating static websites. Static website refers to the website that has fixed content and only displays information without scripting or database design. So, in other words, are the most basic type of websites.</p>
<h2 id="Requirements"><a href="#Requirements" class="headerlink" title="Requirements"></a>Requirements</h2><p>Requirements can vary from system to system. I’m using Ubuntu 20.04 server, fresh install.</p>
<ul>
<li>git</li>
<li>node.js</li>
<li>nginx (You can use any web server you want)</li>
<li>Create a A-type DNS record (if you want it to be public)</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt install git-core npm nginx</span><br><span class="line">sudo systemctl stop nginx <span class="comment"># We don't need it yet</span></span><br><span class="line">sudo npm install -g hexo-cli <span class="comment"># NOT GOOD USING NPM AS ROOT</span></span><br><span class="line">sudo apt install software-properties-common</span><br><span class="line">sudo add-apt-repository universe</span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install certbot</span><br></pre></td></tr></table></figure>

<h2 id="Setting-up"><a href="#Setting-up" class="headerlink" title="Setting up"></a>Setting up</h2><h3 id="Hexo"><a href="#Hexo" class="headerlink" title="Hexo"></a>Hexo</h3><p>To initialize Hexo, you have to run the following</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init &lt;folder&gt;</span><br></pre></td></tr></table></figure>
<p>You can use /var/www/<folder> or any other folder you’d like, and point the web server to it. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> &lt;folder&gt;</span><br><span class="line">hexo generate</span><br></pre></td></tr></table></figure>
<p>This will generate the static files for your website with hexo default options.<br>To view the website, you can run </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo server</span><br></pre></td></tr></table></figure>
<p>Practically you could run your site using hexo server, but using nginx or apache offers more options afterwards.</p>
<h2 id="Let’s-encrypt"><a href="#Let’s-encrypt" class="headerlink" title="Let’s encrypt"></a>Let’s encrypt</h2><p>Before issuing a certificate, Let’s encrypt validates the ownership of the domain. To do so, it creates a temporary token with some information. Then, it makes a HTTP request to retrieve the file and validate the token, which verifies that the DNS record for your domain resolves to the server running the Let’s encrypt client. So make sure you already set up the DNS record.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo certbot certonly --standalone -d blog.grugo.me -d www.blog.grugo.me</span><br></pre></td></tr></table></figure>

<p>If everything went well, you should see something like</p>
<figure class="highlight plain"><figcaption><span>debug log to</span><a href="/var/log/letsencrypt/letsencrypt.log">link</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Plugins selected: Authenticator standalone, Installer None</span><br><span class="line">Obtaining a new certificate</span><br><span class="line">Performing the following challenges:</span><br><span class="line">http-01 challenge for blog.grugo.me</span><br><span class="line">http-01 challenge for www.blog.grugo.me</span><br><span class="line">Waiting for verification...</span><br><span class="line">Cleaning up challenges</span><br><span class="line"></span><br><span class="line">IMPORTANT NOTES:</span><br><span class="line"> - Congratulations! Your certificate and chain have been saved at:</span><br><span class="line">   &#x2F;etc&#x2F;letsencrypt&#x2F;live&#x2F;blog.grugo.me&#x2F;fullchain.pem</span><br><span class="line">   Your key file has been saved at:</span><br><span class="line">   &#x2F;etc&#x2F;letsencrypt&#x2F;live&#x2F;blog.grugo.me&#x2F;privkey.pem</span><br><span class="line">   Your cert will expire on 2020-07-30. To obtain a new or tweaked</span><br><span class="line">   version of this certificate in the future, simply run certbot</span><br><span class="line">   again. To non-interactively renew *all* of your certificates, run</span><br><span class="line">   &quot;certbot renew&quot;</span><br><span class="line"> - If you like Certbot, please consider supporting our work by:</span><br><span class="line"></span><br><span class="line">   Donating to ISRG &#x2F; Let&#39;s Encrypt:   https:&#x2F;&#x2F;letsencrypt.org&#x2F;donate</span><br><span class="line">   Donating to EFF:                    https:&#x2F;&#x2F;eff.org&#x2F;donate-le</span><br></pre></td></tr></table></figure>

<p>fullchain.pem is valid for, in this case, both domains, blog.grugo.me and <a href="http://www.blog.grugo.me" target="_blank" rel="noopener">www.blog.grugo.me</a>.</p>
<p>Let’s Encrypt certificates expire after 90 days. However, you can set up an automatic renewal of the certificates. See below.</p>
<h3 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h3><p>The idea is to set up and serve the blog in HTTPS, while redirecting all HTTP traffic to HTTPS.</p>
<p>My config looks something like</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">	listen 80 default_server;</span><br><span class="line">	listen 443 ssl default_server;</span><br><span class="line"></span><br><span class="line">	root &#x2F;var&#x2F;www&#x2F;blog.grugo.me&#x2F;public;</span><br><span class="line"></span><br><span class="line">	index index.html index.htm index.nginx-debian.html;</span><br><span class="line"></span><br><span class="line">	ssl_certificate &#x2F;etc&#x2F;letsencrypt&#x2F;live&#x2F;blog.grugo.me&#x2F;fullchain.pem;</span><br><span class="line">	ssl_certificate_key &#x2F;etc&#x2F;letsencrypt&#x2F;live&#x2F;blog.grugo.me&#x2F;privkey.pem;</span><br><span class="line">	include &#x2F;etc&#x2F;letsencrypt&#x2F;options-ssl-nginx.conf;</span><br><span class="line"></span><br><span class="line">	server_name blog.grugo.me www.blog.grugo.me;</span><br><span class="line"></span><br><span class="line">	location &#x2F; &#123;</span><br><span class="line">		try_files $uri $uri&#x2F; &#x3D;404;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	# Redirect non-https traffic to https</span><br><span class="line">	if ($scheme !&#x3D; &quot;https&quot;) &#123;</span><br><span class="line">        	return 301 https:&#x2F;&#x2F;$host$request_uri;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>I am listening in both 80 and 443 TCP ports to server both HTTP and HTTPS. However, I set up a redirect rule from HTTP to HTTPS, so no insecure traffic is serve.</p>
<h2 id="Automatically-Renew-Let’s-Encrypt-Certificate"><a href="#Automatically-Renew-Let’s-Encrypt-Certificate" class="headerlink" title="Automatically Renew Let’s Encrypt Certificate"></a>Automatically Renew Let’s Encrypt Certificate</h2><p>You can set up a cron job in a crontab to renew automatically the certificate.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure>
<p>In the editor, add the following line</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 12 * * * &#x2F;usr&#x2F;bin&#x2F;certbot renew --quiet</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://blog.grugo.me/2020/05/01/How-to-install-and-set-up-hexo-nginx-let-s-encrypt/" data-id="ck9o7t8t9000025cscl8x8mcf" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/01/hello-world/" class="article-date">
  <time datetime="2020-05-01T09:54:27.996Z" itemprop="datePublished">2020-05-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/01/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://blog.grugo.me/2020/05/01/hello-world/" data-id="ck9o1agv00000bgcscce1dnwy" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/05/01/How-to-install-and-set-up-hexo-nginx-let-s-encrypt/">How to install and set up hexo + nginx + let&#39;s encrypt</a>
          </li>
        
          <li>
            <a href="/2020/05/01/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 Guido Rugo<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>